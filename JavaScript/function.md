# 函数

函数(function)，也可以称之为方法(method),是一段 **预定义好** ，并可以被 **反复使用** 的代码块，其中包含多条可执行语句

**预定义好**：事先声明好，但不执行

**反复使用**：允许被多个元素或者函数使用

**代码块**：包含多条可执行的代码

## 语法

```js
function 函数名() {
  可执行语句;
}
```

## 函数的调用

执行函数中的内容

```js
function hello() {
  console.log("hello");
}

hello();
```

## 参数与返回值

**带参数的函数**

```js
function 函数名(参数列表) {
  //代码块
}
```

参数列表：由一个或多个变量名称组成
声明函数时定义的参数，称为 **形参**

例子：

```js
function printInfo(name, password) {
  console.log("用户名:" + name + "密码:" + password);
}

prinInfo("admin", "123456");
```

在调用函数时所传递的参数值称为**实参**

**带返回值的函数**

```js
function 函数名(参数列表) {
  //代码块
  return 值;
}
```

例子：

```js
function add(num1, num2) {
  return num1 + num2;
}

var result = add(1, 2);
console.log(result);
```

## 变量的作用域

作用域是变量或函数的可访问范围，其控制着变量或函数的可见性和**生命周期**

**函数作用域** 只在当前函数内可访问

**全局作用域** 任何位置都可以访问

## 局部变量

函数作用域中的变量称为局部变量，只在当前函数内可以访问到

```js
function add() {
  var sum = 1 + 2; //局部变量
  console.log(sum); // 输出3
}
console.log(sum); //报错，sum只在函数内可以访问
```

## 全局变量 :id=global_variable

```js
var sum = 0; 、// 全局变量
function add(){
    sum = 1 + 2;
    console.log(sum); //输出3
}
console.log(sum); //正确 输出3
```

```js
// 全局变量
function add() {
  sum = 1 + 2; // 未用var声明的变量，默认为全局变量
}
add(); //必须调用一次
console.log(sum); //正确 输出3
```

## 按值传递

传递参数时，实际上是将 实参 复制一份副本传递给函数。在函数内对变量进行修改，实际上不会影响到外部的实参变量

```js
var n = 100; //全局变量
function fun(n) {
  //参数变量也是局部变量
  n += 3;
  console.log(n);
}
fun(n); // 按值传递，方法内输出103
console.log(n); //输出全局变量的值100
```

！> 如果`fun`函数没有参数的，最后输出的就不是 100，是 103，因为并没有传递值进去，而是直接操作全局变量

## 垃圾回收

Javascript 通过自动内存管理实现内存分配和闲置资源的回收，简单来说就是每隔一定时间就去确定那个变量不会再使用，然后释放它占用的内存。具体的实现方法就是去标记变量，然后跟踪变量，常用的标记策略是**标记清理**

### 标记清理

当变量进入一个作用域或者代码块的时候，就会被加上存在该区域的标记，当变量离开的时候就被加上离开的标记，加标记的方法有很多种，比如维护“在上下文”和“不在上下文中”两个变量列表

### 引用计数

另一种不常用的标记策略，就是统计变量的引用数，当变量不在被引用就被清理内存
但是这个有个 bug，如果在函数内两个变量互相引用，在函数结束后他们的引用数都是 2，永远不会变成 0，如果函数被多次调用就会导致大量内存不会被释放。
这就是 IE8 以及更早版本运行慢的原因之一。

### 内存管理

一个好的页面应该使其内存占用量保持在一个较小的值才对。为了避免运行大量 Javascript 的网页耗尽系统内存而导致操作系统崩溃，系统分配给浏览器的内存通常比桌面软件要少的很多。
优化内存占用的最佳手段就是只保存必要的数据，不再使用的的变量将他设置为`null`，这叫做**解除引用**
在 ES6 中的`let`和`const`两个声明变量的关键字不仅可以改善代码风格，而且有助于改进垃圾回收的过程，因为这两个关键字的作用域要比`var`的作用域小，从而使变量可能更早地被回收。
同时可以达到防止内存泄漏的作用，比如我们在声明变量的时候，如果不加`var\let\const`那么变量就会成为全局变量，会被当成`window`的属性来创建，从而只要`window`不被清除就不会被释放
